# Rice Search - Go Edition
# Environment Configuration
# Copy to .env and customize for your environment

# =============================================================================
# Server Configuration
# =============================================================================

# HTTP server host and port
RICE_HOST=0.0.0.0
RICE_PORT=8080

# Enable/disable services (monolith mode)
RICE_ENABLE_WEB=true
RICE_ENABLE_ML=true

# =============================================================================
# Qdrant Configuration
# =============================================================================

# Qdrant connection URL
QDRANT_URL=http://localhost:6333

# Qdrant API key (optional, for Qdrant Cloud)
# QDRANT_API_KEY=

# Collection prefix (useful for multi-tenant)
QDRANT_COLLECTION_PREFIX=rice_

# =============================================================================
# ML/ONNX Configuration
# =============================================================================

# Device for ML inference: cpu, cuda, tensorrt
RICE_ML_DEVICE=cpu

# CUDA device ID (if using GPU)
RICE_ML_CUDA_DEVICE=0

# Model paths (relative to models/ directory or absolute)
RICE_EMBED_MODEL=jina-embeddings-v3
RICE_SPARSE_MODEL=splade-v3
RICE_RERANK_MODEL=jina-reranker-v2

# Embedding dimensions (must match model)
RICE_EMBED_DIM=1536

# Batch sizes for inference
RICE_EMBED_BATCH_SIZE=32
RICE_SPARSE_BATCH_SIZE=32
RICE_RERANK_BATCH_SIZE=16

# Max sequence length
RICE_MAX_SEQ_LENGTH=8192

# =============================================================================
# Cache Configuration
# =============================================================================

# Cache type: memory, redis
RICE_CACHE_TYPE=memory

# Memory cache size (number of entries)
RICE_CACHE_SIZE=10000

# Redis URL (if cache type is redis)
RICE_REDIS_URL=redis://localhost:6379

# Cache TTL in seconds (0 = never expire for embeddings)
RICE_CACHE_TTL=0

# =============================================================================
# Event Bus Configuration
# =============================================================================

# Bus type: memory, kafka, nats, redis
RICE_BUS_TYPE=memory

# Kafka brokers (comma-separated)
# RICE_KAFKA_BROKERS=localhost:9092

# NATS URL
# RICE_NATS_URL=nats://localhost:4222

# Redis Streams URL (for bus, can be same as cache)
# RICE_REDIS_STREAM_URL=redis://localhost:6379

# =============================================================================
# Indexing Configuration
# =============================================================================

# Maximum chunk size (tokens)
RICE_CHUNK_SIZE=512

# Chunk overlap (tokens)
RICE_CHUNK_OVERLAP=64

# Concurrent indexing workers
RICE_INDEX_WORKERS=4

# =============================================================================
# Search Configuration
# =============================================================================

# Default top_k results
RICE_DEFAULT_TOP_K=20

# Default sparse weight (0.0-1.0)
RICE_DEFAULT_SPARSE_WEIGHT=0.5

# Default dense weight (0.0-1.0)
RICE_DEFAULT_DENSE_WEIGHT=0.5

# Enable reranking by default
RICE_ENABLE_RERANKING=true

# Rerank candidates multiplier
RICE_RERANK_CANDIDATES=30

# =============================================================================
# Logging Configuration
# =============================================================================

# Log level: debug, info, warn, error
RICE_LOG_LEVEL=info

# Log format: text, json
RICE_LOG_FORMAT=text

# Log file (empty = stdout)
# RICE_LOG_FILE=

# =============================================================================
# Security Configuration
# =============================================================================

# API key for authentication (empty = no auth)
# RICE_API_KEY=

# Rate limit (requests per second, 0 = disabled)
RICE_RATE_LIMIT=0

# CORS allowed origins (comma-separated, * = all)
RICE_CORS_ORIGINS=*

# =============================================================================
# Observability Configuration
# =============================================================================

# Enable Prometheus metrics endpoint
RICE_METRICS_ENABLED=true

# Metrics endpoint path
RICE_METRICS_PATH=/metrics

# Enable request tracing
RICE_TRACING_ENABLED=false

# Jaeger/OTLP endpoint
# RICE_TRACING_ENDPOINT=http://localhost:4318

# =============================================================================
# Microservices Mode (optional - for distributed deployment)
# =============================================================================

# External ML service URL (skip embedded ML)
# RICE_ML_URL=http://ml-service:8081

# External Search service URL (skip embedded search)
# RICE_SEARCH_URL=http://search-service:8082
