// Code generated by protoc-gen-go. DO NOT EDIT.
// source: ricesearch.proto

package ricesearchpb

import (
	"time"

	"google.golang.org/protobuf/types/known/durationpb"
	"google.golang.org/protobuf/types/known/timestamppb"
)

// HealthStatus represents the health status of a service.
type HealthStatus int32

const (
	HealthStatus_HEALTH_STATUS_UNSPECIFIED HealthStatus = 0
	HealthStatus_HEALTH_STATUS_HEALTHY     HealthStatus = 1
	HealthStatus_HEALTH_STATUS_DEGRADED    HealthStatus = 2
	HealthStatus_HEALTH_STATUS_UNHEALTHY   HealthStatus = 3
)

func (h HealthStatus) String() string {
	switch h {
	case HealthStatus_HEALTH_STATUS_HEALTHY:
		return "healthy"
	case HealthStatus_HEALTH_STATUS_DEGRADED:
		return "degraded"
	case HealthStatus_HEALTH_STATUS_UNHEALTHY:
		return "unhealthy"
	default:
		return "unspecified"
	}
}

// =============================================================================
// Search Messages
// =============================================================================

// SearchRequest represents a search request.
type SearchRequest struct {
	Query           string        `json:"query"`
	Store           string        `json:"store"`
	TopK            int32         `json:"top_k,omitempty"`
	Filter          *SearchFilter `json:"filter,omitempty"`
	EnableReranking *bool         `json:"enable_reranking,omitempty"`
	RerankTopK      int32         `json:"rerank_top_k,omitempty"`
	IncludeContent  bool          `json:"include_content,omitempty"`
	SparseWeight    *float32      `json:"sparse_weight,omitempty"`
	DenseWeight     *float32      `json:"dense_weight,omitempty"`
	ConnectionID    string        `json:"connection_id,omitempty"` // Filter by connection
}

// SearchFilter defines search filters.
type SearchFilter struct {
	PathPrefix string   `json:"path_prefix,omitempty"`
	Languages  []string `json:"languages,omitempty"`
}

// SearchResult represents a single search result.
type SearchResult struct {
	ID          string   `json:"id"`
	Path        string   `json:"path"`
	Language    string   `json:"language"`
	StartLine   int32    `json:"start_line"`
	EndLine     int32    `json:"end_line"`
	Content     string   `json:"content,omitempty"`
	Symbols     []string `json:"symbols,omitempty"`
	Score       float32  `json:"score"`
	RerankScore *float32 `json:"rerank_score,omitempty"`
}

// SearchResponse represents a search response.
type SearchResponse struct {
	Query    string          `json:"query"`
	Store    string          `json:"store"`
	Results  []*SearchResult `json:"results"`
	Total    int32           `json:"total"`
	Metadata *SearchMetadata `json:"metadata"`
}

// SearchMetadata contains search metadata.
type SearchMetadata struct {
	SearchTimeMs       int64 `json:"search_time_ms"`
	EmbedTimeMs        int64 `json:"embed_time_ms"`
	RetrievalTimeMs    int64 `json:"retrieval_time_ms"`
	RerankTimeMs       int64 `json:"rerank_time_ms,omitempty"`
	CandidatesReranked int32 `json:"candidates_reranked,omitempty"`
	RerankingApplied   bool  `json:"reranking_applied"`
}

// =============================================================================
// Index Messages
// =============================================================================

// IndexRequest represents a request to index a document.
type IndexRequest struct {
	Store        string    `json:"store"`
	Document     *Document `json:"document"`
	Force        bool      `json:"force,omitempty"`
	ConnectionID string    `json:"connection_id,omitempty"` // Track source connection
}

// IndexBatchRequest represents a request to index multiple documents.
type IndexBatchRequest struct {
	Store        string      `json:"store"`
	Documents    []*Document `json:"documents"`
	Force        bool        `json:"force,omitempty"`
	ConnectionID string      `json:"connection_id,omitempty"` // Track source connection
}

// Document represents a source code file.
type Document struct {
	Path     string `json:"path"`
	Content  string `json:"content"`
	Language string `json:"language,omitempty"`
}

// IndexResponse represents the result of an indexing operation.
type IndexResponse struct {
	Store        string               `json:"store"`
	Indexed      int32                `json:"indexed"`
	Skipped      int32                `json:"skipped"`
	Failed       int32                `json:"failed"`
	ChunksTotal  int32                `json:"chunks_total"`
	Duration     *durationpb.Duration `json:"duration"`
	Errors       []*IndexError        `json:"errors,omitempty"`
	DocumentInfo []*DocumentInfo      `json:"document_info,omitempty"`
}

// GetDuration returns the duration as time.Duration.
func (r *IndexResponse) GetDuration() time.Duration {
	if r.Duration == nil {
		return 0
	}
	return r.Duration.AsDuration()
}

// IndexError represents an error during indexing.
type IndexError struct {
	Path    string `json:"path"`
	Message string `json:"message"`
}

// DocumentInfo contains info about an indexed document.
type DocumentInfo struct {
	Path       string `json:"path"`
	Hash       string `json:"hash"`
	ChunkCount int32  `json:"chunk_count"`
	Status     string `json:"status"`
}

// DeleteRequest represents a request to delete documents.
type DeleteRequest struct {
	Store      string   `json:"store"`
	Paths      []string `json:"paths,omitempty"`
	PathPrefix string   `json:"path_prefix,omitempty"`
}

// DeleteResponse represents the result of a delete operation.
type DeleteResponse struct {
	Deleted int32 `json:"deleted"`
}

// SyncRequest represents a request to sync the index.
type SyncRequest struct {
	Store        string   `json:"store"`
	CurrentPaths []string `json:"current_paths"`
}

// SyncResponse represents the result of a sync operation.
type SyncResponse struct {
	Removed int32 `json:"removed"`
}

// ReindexRequest represents a request to reindex documents.
type ReindexRequest struct {
	Store     string      `json:"store"`
	Documents []*Document `json:"documents"`
}

// GetIndexStatsRequest represents a request to get index stats.
type GetIndexStatsRequest struct {
	Store string `json:"store"`
}

// IndexStats contains statistics about an index.
type IndexStats struct {
	Store       string `json:"store"`
	TotalChunks int32  `json:"total_chunks"`
	TotalFiles  int32  `json:"total_files"`
}

// =============================================================================
// Store Messages
// =============================================================================

// Store represents an isolated search index.
type Store struct {
	Name        string                 `json:"name"`
	DisplayName string                 `json:"display_name,omitempty"`
	Description string                 `json:"description,omitempty"`
	Config      *StoreConfig           `json:"config,omitempty"`
	Stats       *StoreStats            `json:"stats,omitempty"`
	CreatedAt   *timestamppb.Timestamp `json:"created_at,omitempty"`
	UpdatedAt   *timestamppb.Timestamp `json:"updated_at,omitempty"`
}

// GetCreatedAt returns the creation time as time.Time.
func (s *Store) GetCreatedAt() time.Time {
	if s.CreatedAt == nil {
		return time.Time{}
	}
	return s.CreatedAt.AsTime()
}

// GetUpdatedAt returns the update time as time.Time.
func (s *Store) GetUpdatedAt() time.Time {
	if s.UpdatedAt == nil {
		return time.Time{}
	}
	return s.UpdatedAt.AsTime()
}

// StoreConfig holds configuration for a store.
type StoreConfig struct {
	EmbedModel   string `json:"embed_model,omitempty"`
	SparseModel  string `json:"sparse_model,omitempty"`
	ChunkSize    int32  `json:"chunk_size,omitempty"`
	ChunkOverlap int32  `json:"chunk_overlap,omitempty"`
}

// StoreStats holds statistics for a store.
type StoreStats struct {
	DocumentCount int64                  `json:"document_count"`
	ChunkCount    int64                  `json:"chunk_count"`
	TotalSize     int64                  `json:"total_size"`
	LastIndexed   *timestamppb.Timestamp `json:"last_indexed,omitempty"`
}

// GetLastIndexed returns the last indexed time as time.Time.
func (s *StoreStats) GetLastIndexed() time.Time {
	if s.LastIndexed == nil {
		return time.Time{}
	}
	return s.LastIndexed.AsTime()
}

// ListStoresRequest is empty.
type ListStoresRequest struct{}

// ListStoresResponse contains a list of stores.
type ListStoresResponse struct {
	Stores []*Store `json:"stores"`
}

// CreateStoreRequest represents a request to create a store.
type CreateStoreRequest struct {
	Name        string       `json:"name"`
	DisplayName string       `json:"display_name,omitempty"`
	Description string       `json:"description,omitempty"`
	Config      *StoreConfig `json:"config,omitempty"`
}

// GetStoreRequest represents a request to get a store.
type GetStoreRequest struct {
	Name string `json:"name"`
}

// DeleteStoreRequest represents a request to delete a store.
type DeleteStoreRequest struct {
	Name string `json:"name"`
}

// DeleteStoreResponse represents the result of a store deletion.
type DeleteStoreResponse struct {
	Success bool `json:"success"`
}

// GetStoreStatsRequest represents a request to get store stats.
type GetStoreStatsRequest struct {
	Name string `json:"name"`
}

// =============================================================================
// Health & Version Messages
// =============================================================================

// HealthRequest is empty.
type HealthRequest struct{}

// HealthResponse contains health status.
type HealthResponse struct {
	Status     HealthStatus                `json:"status"`
	Components map[string]*ComponentHealth `json:"components,omitempty"`
	Version    string                      `json:"version"`
}

// ComponentHealth contains health status for a component.
type ComponentHealth struct {
	Status  HealthStatus         `json:"status"`
	Message string               `json:"message,omitempty"`
	Latency *durationpb.Duration `json:"latency,omitempty"`
}

// GetLatency returns the latency as time.Duration.
func (c *ComponentHealth) GetLatency() time.Duration {
	if c.Latency == nil {
		return 0
	}
	return c.Latency.AsDuration()
}

// VersionRequest is empty.
type VersionRequest struct{}

// VersionResponse contains version information.
type VersionResponse struct {
	Version   string `json:"version"`
	Commit    string `json:"commit"`
	BuildDate string `json:"build_date"`
	GoVersion string `json:"go_version"`
}

// =============================================================================
// Connection Management Messages
// =============================================================================

// Connection represents a client PC connection.
type Connection struct {
	ID           string                 `json:"id"`
	Name         string                 `json:"name"`
	PCInfo       *PCInfo                `json:"pc_info,omitempty"`
	StoreAccess  []string               `json:"store_access,omitempty"`
	CreatedAt    *timestamppb.Timestamp `json:"created_at,omitempty"`
	LastSeenAt   *timestamppb.Timestamp `json:"last_seen_at,omitempty"`
	LastIP       string                 `json:"last_ip,omitempty"`
	IndexedFiles int64                  `json:"indexed_files"`
	SearchCount  int64                  `json:"search_count"`
	IsActive     bool                   `json:"is_active"`
}

// GetCreatedAt returns the creation time as time.Time.
func (c *Connection) GetCreatedAt() time.Time {
	if c.CreatedAt == nil {
		return time.Time{}
	}
	return c.CreatedAt.AsTime()
}

// GetLastSeenAt returns the last seen time as time.Time.
func (c *Connection) GetLastSeenAt() time.Time {
	if c.LastSeenAt == nil {
		return time.Time{}
	}
	return c.LastSeenAt.AsTime()
}

// PCInfo contains PC information.
type PCInfo struct {
	Hostname   string `json:"hostname"`
	OS         string `json:"os"`
	Arch       string `json:"arch"`
	MACAddress string `json:"mac_address,omitempty"`
	Username   string `json:"username,omitempty"`
}

// RegisterConnectionRequest is a request to register a connection.
type RegisterConnectionRequest struct {
	Name   string  `json:"name"`
	PCInfo *PCInfo `json:"pc_info,omitempty"`
}

// ListConnectionsRequest is a request to list connections.
type ListConnectionsRequest struct {
	StoreFilter string `json:"store_filter,omitempty"`
	ActiveOnly  bool   `json:"active_only"`
}

// ListConnectionsResponse contains a list of connections.
type ListConnectionsResponse struct {
	Connections []*Connection `json:"connections"`
}

// GetConnectionRequest is a request to get a connection.
type GetConnectionRequest struct {
	ID string `json:"id"`
}

// DeleteConnectionRequest is a request to delete a connection.
type DeleteConnectionRequest struct {
	ID string `json:"id"`
}

// DeleteConnectionResponse is the result of a connection deletion.
type DeleteConnectionResponse struct {
	Success bool `json:"success"`
}

// =============================================================================
// Model Management Messages
// =============================================================================

// ModelInfo contains information about an ML model.
type ModelInfo struct {
	ID          string `json:"id"`
	Type        string `json:"type"` // embed, rerank, query_understand
	DisplayName string `json:"display_name"`
	Description string `json:"description,omitempty"`
	OutputDim   int32  `json:"output_dim,omitempty"`
	MaxTokens   int32  `json:"max_tokens"`
	Downloaded  bool   `json:"downloaded"`
	IsDefault   bool   `json:"is_default"`
	GPUEnabled  bool   `json:"gpu_enabled"`
	Size        int64  `json:"size"`
}

// ListModelsRequest is a request to list models.
type ListModelsRequest struct {
	TypeFilter string `json:"type_filter,omitempty"`
}

// ListModelsResponse contains a list of models.
type ListModelsResponse struct {
	Models []*ModelInfo `json:"models"`
}

// DownloadModelRequest is a request to download a model.
type DownloadModelRequest struct {
	ModelID string `json:"model_id"`
}

// DownloadModelResponse is the result of a model download.
type DownloadModelResponse struct {
	Success  bool   `json:"success"`
	Message  string `json:"message,omitempty"`
	Progress int32  `json:"progress"` // 0-100
}

// SetDefaultModelRequest is a request to set a default model.
type SetDefaultModelRequest struct {
	ModelType string `json:"model_type"`
	ModelID   string `json:"model_id"`
}

// ToggleGPURequest is a request to toggle GPU for a model.
type ToggleGPURequest struct {
	ModelID string `json:"model_id"`
	Enabled bool   `json:"enabled"`
}

// =============================================================================
// Model Mapper Messages
// =============================================================================

// ModelMapper defines how to use a model.
type ModelMapper struct {
	ID             string                 `json:"id"`
	Name           string                 `json:"name"`
	ModelID        string                 `json:"model_id"`
	Type           string                 `json:"type"`
	PromptTemplate string                 `json:"prompt_template,omitempty"`
	InputMapping   map[string]string      `json:"input_mapping,omitempty"`
	OutputMapping  map[string]string      `json:"output_mapping,omitempty"`
	CreatedAt      *timestamppb.Timestamp `json:"created_at,omitempty"`
	UpdatedAt      *timestamppb.Timestamp `json:"updated_at,omitempty"`
}

// GetCreatedAt returns the creation time as time.Time.
func (m *ModelMapper) GetCreatedAt() time.Time {
	if m.CreatedAt == nil {
		return time.Time{}
	}
	return m.CreatedAt.AsTime()
}

// GetUpdatedAt returns the update time as time.Time.
func (m *ModelMapper) GetUpdatedAt() time.Time {
	if m.UpdatedAt == nil {
		return time.Time{}
	}
	return m.UpdatedAt.AsTime()
}

// ListMappersRequest is a request to list mappers.
type ListMappersRequest struct{}

// ListMappersResponse contains a list of mappers.
type ListMappersResponse struct {
	Mappers []*ModelMapper `json:"mappers"`
}

// CreateMapperRequest is a request to create a mapper.
type CreateMapperRequest struct {
	Mapper *ModelMapper `json:"mapper"`
}

// UpdateMapperRequest is a request to update a mapper.
type UpdateMapperRequest struct {
	Mapper *ModelMapper `json:"mapper"`
}

// DeleteMapperRequest is a request to delete a mapper.
type DeleteMapperRequest struct {
	ID string `json:"id"`
}

// DeleteMapperResponse is the result of a mapper deletion.
type DeleteMapperResponse struct {
	Success bool `json:"success"`
}

// GenerateMapperRequest is a request to auto-generate a mapper.
type GenerateMapperRequest struct {
	ModelID string `json:"model_id"`
	Type    string `json:"type"`
}

// =============================================================================
// File Browser Messages
// =============================================================================

// IndexedFile represents an indexed file.
type IndexedFile struct {
	Path         string                 `json:"path"`
	Language     string                 `json:"language"`
	Size         int64                  `json:"size"`
	Hash         string                 `json:"hash"`
	ChunkCount   int32                  `json:"chunk_count"`
	ConnectionID string                 `json:"connection_id,omitempty"`
	IndexedAt    *timestamppb.Timestamp `json:"indexed_at,omitempty"`
	Status       string                 `json:"status"` // indexed, pending, error
}

// GetIndexedAt returns the indexed time as time.Time.
func (f *IndexedFile) GetIndexedAt() time.Time {
	if f.IndexedAt == nil {
		return time.Time{}
	}
	return f.IndexedAt.AsTime()
}

// ListFilesRequest is a request to list indexed files.
type ListFilesRequest struct {
	Store        string `json:"store"`
	PathPrefix   string `json:"path_prefix,omitempty"`
	Language     string `json:"language,omitempty"`
	ConnectionID string `json:"connection_id,omitempty"`
	Status       string `json:"status,omitempty"`
	Page         int32  `json:"page"`
	PageSize     int32  `json:"page_size"`
	SortBy       string `json:"sort_by,omitempty"`    // path, size, indexed_at
	SortOrder    string `json:"sort_order,omitempty"` // asc, desc
}

// ListFilesResponse contains a paginated list of files.
type ListFilesResponse struct {
	Files      []*IndexedFile `json:"files"`
	Total      int32          `json:"total"`
	Page       int32          `json:"page"`
	PageSize   int32          `json:"page_size"`
	TotalPages int32          `json:"total_pages"`
}

// =============================================================================
// Query Understanding Messages
// =============================================================================

// ParsedQuery represents a parsed query with extracted intent.
type ParsedQuery struct {
	Original     string   `json:"original"`
	Normalized   string   `json:"normalized"`
	Keywords     []string `json:"keywords,omitempty"`
	CodeTerms    []string `json:"code_terms,omitempty"`
	ActionIntent string   `json:"action_intent,omitempty"`
	TargetType   string   `json:"target_type,omitempty"`
	Expanded     []string `json:"expanded,omitempty"`
	SearchQuery  string   `json:"search_query"`
	Confidence   float32  `json:"confidence"`
	UsedModel    bool     `json:"used_model"`
}
