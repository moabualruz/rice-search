// Code generated by protoc-gen-go. DO NOT EDIT.
// source: ricesearch.proto

package ricesearchpb

import (
	"time"

	"google.golang.org/protobuf/types/known/durationpb"
	"google.golang.org/protobuf/types/known/timestamppb"
)

// HealthStatus represents the health status of a service.
type HealthStatus int32

const (
	HealthStatus_HEALTH_STATUS_UNSPECIFIED HealthStatus = 0
	HealthStatus_HEALTH_STATUS_HEALTHY     HealthStatus = 1
	HealthStatus_HEALTH_STATUS_DEGRADED    HealthStatus = 2
	HealthStatus_HEALTH_STATUS_UNHEALTHY   HealthStatus = 3
)

func (h HealthStatus) String() string {
	switch h {
	case HealthStatus_HEALTH_STATUS_HEALTHY:
		return "healthy"
	case HealthStatus_HEALTH_STATUS_DEGRADED:
		return "degraded"
	case HealthStatus_HEALTH_STATUS_UNHEALTHY:
		return "unhealthy"
	default:
		return "unspecified"
	}
}

// =============================================================================
// Search Messages
// =============================================================================

// SearchRequest represents a search request.
type SearchRequest struct {
	Query           string        `json:"query"`
	Store           string        `json:"store"`
	TopK            int32         `json:"top_k,omitempty"`
	Filter          *SearchFilter `json:"filter,omitempty"`
	EnableReranking *bool         `json:"enable_reranking,omitempty"`
	RerankTopK      int32         `json:"rerank_top_k,omitempty"`
	IncludeContent  bool          `json:"include_content,omitempty"`
	SparseWeight    *float32      `json:"sparse_weight,omitempty"`
	DenseWeight     *float32      `json:"dense_weight,omitempty"`
}

// SearchFilter defines search filters.
type SearchFilter struct {
	PathPrefix string   `json:"path_prefix,omitempty"`
	Languages  []string `json:"languages,omitempty"`
}

// SearchResult represents a single search result.
type SearchResult struct {
	ID          string   `json:"id"`
	Path        string   `json:"path"`
	Language    string   `json:"language"`
	StartLine   int32    `json:"start_line"`
	EndLine     int32    `json:"end_line"`
	Content     string   `json:"content,omitempty"`
	Symbols     []string `json:"symbols,omitempty"`
	Score       float32  `json:"score"`
	RerankScore *float32 `json:"rerank_score,omitempty"`
}

// SearchResponse represents a search response.
type SearchResponse struct {
	Query    string          `json:"query"`
	Store    string          `json:"store"`
	Results  []*SearchResult `json:"results"`
	Total    int32           `json:"total"`
	Metadata *SearchMetadata `json:"metadata"`
}

// SearchMetadata contains search metadata.
type SearchMetadata struct {
	SearchTimeMs       int64 `json:"search_time_ms"`
	EmbedTimeMs        int64 `json:"embed_time_ms"`
	RetrievalTimeMs    int64 `json:"retrieval_time_ms"`
	RerankTimeMs       int64 `json:"rerank_time_ms,omitempty"`
	CandidatesReranked int32 `json:"candidates_reranked,omitempty"`
	RerankingApplied   bool  `json:"reranking_applied"`
}

// =============================================================================
// Index Messages
// =============================================================================

// IndexRequest represents a request to index a document.
type IndexRequest struct {
	Store    string    `json:"store"`
	Document *Document `json:"document"`
	Force    bool      `json:"force,omitempty"`
}

// IndexBatchRequest represents a request to index multiple documents.
type IndexBatchRequest struct {
	Store     string      `json:"store"`
	Documents []*Document `json:"documents"`
	Force     bool        `json:"force,omitempty"`
}

// Document represents a source code file.
type Document struct {
	Path     string `json:"path"`
	Content  string `json:"content"`
	Language string `json:"language,omitempty"`
}

// IndexResponse represents the result of an indexing operation.
type IndexResponse struct {
	Store        string               `json:"store"`
	Indexed      int32                `json:"indexed"`
	Skipped      int32                `json:"skipped"`
	Failed       int32                `json:"failed"`
	ChunksTotal  int32                `json:"chunks_total"`
	Duration     *durationpb.Duration `json:"duration"`
	Errors       []*IndexError        `json:"errors,omitempty"`
	DocumentInfo []*DocumentInfo      `json:"document_info,omitempty"`
}

// GetDuration returns the duration as time.Duration.
func (r *IndexResponse) GetDuration() time.Duration {
	if r.Duration == nil {
		return 0
	}
	return r.Duration.AsDuration()
}

// IndexError represents an error during indexing.
type IndexError struct {
	Path    string `json:"path"`
	Message string `json:"message"`
}

// DocumentInfo contains info about an indexed document.
type DocumentInfo struct {
	Path       string `json:"path"`
	Hash       string `json:"hash"`
	ChunkCount int32  `json:"chunk_count"`
	Status     string `json:"status"`
}

// DeleteRequest represents a request to delete documents.
type DeleteRequest struct {
	Store      string   `json:"store"`
	Paths      []string `json:"paths,omitempty"`
	PathPrefix string   `json:"path_prefix,omitempty"`
}

// DeleteResponse represents the result of a delete operation.
type DeleteResponse struct {
	Deleted int32 `json:"deleted"`
}

// SyncRequest represents a request to sync the index.
type SyncRequest struct {
	Store        string   `json:"store"`
	CurrentPaths []string `json:"current_paths"`
}

// SyncResponse represents the result of a sync operation.
type SyncResponse struct {
	Removed int32 `json:"removed"`
}

// ReindexRequest represents a request to reindex documents.
type ReindexRequest struct {
	Store     string      `json:"store"`
	Documents []*Document `json:"documents"`
}

// GetIndexStatsRequest represents a request to get index stats.
type GetIndexStatsRequest struct {
	Store string `json:"store"`
}

// IndexStats contains statistics about an index.
type IndexStats struct {
	Store       string `json:"store"`
	TotalChunks int32  `json:"total_chunks"`
	TotalFiles  int32  `json:"total_files"`
}

// =============================================================================
// Store Messages
// =============================================================================

// Store represents an isolated search index.
type Store struct {
	Name        string                 `json:"name"`
	DisplayName string                 `json:"display_name,omitempty"`
	Description string                 `json:"description,omitempty"`
	Config      *StoreConfig           `json:"config,omitempty"`
	Stats       *StoreStats            `json:"stats,omitempty"`
	CreatedAt   *timestamppb.Timestamp `json:"created_at,omitempty"`
	UpdatedAt   *timestamppb.Timestamp `json:"updated_at,omitempty"`
}

// GetCreatedAt returns the creation time as time.Time.
func (s *Store) GetCreatedAt() time.Time {
	if s.CreatedAt == nil {
		return time.Time{}
	}
	return s.CreatedAt.AsTime()
}

// GetUpdatedAt returns the update time as time.Time.
func (s *Store) GetUpdatedAt() time.Time {
	if s.UpdatedAt == nil {
		return time.Time{}
	}
	return s.UpdatedAt.AsTime()
}

// StoreConfig holds configuration for a store.
type StoreConfig struct {
	EmbedModel   string `json:"embed_model,omitempty"`
	SparseModel  string `json:"sparse_model,omitempty"`
	ChunkSize    int32  `json:"chunk_size,omitempty"`
	ChunkOverlap int32  `json:"chunk_overlap,omitempty"`
}

// StoreStats holds statistics for a store.
type StoreStats struct {
	DocumentCount int64                  `json:"document_count"`
	ChunkCount    int64                  `json:"chunk_count"`
	TotalSize     int64                  `json:"total_size"`
	LastIndexed   *timestamppb.Timestamp `json:"last_indexed,omitempty"`
}

// GetLastIndexed returns the last indexed time as time.Time.
func (s *StoreStats) GetLastIndexed() time.Time {
	if s.LastIndexed == nil {
		return time.Time{}
	}
	return s.LastIndexed.AsTime()
}

// ListStoresRequest is empty.
type ListStoresRequest struct{}

// ListStoresResponse contains a list of stores.
type ListStoresResponse struct {
	Stores []*Store `json:"stores"`
}

// CreateStoreRequest represents a request to create a store.
type CreateStoreRequest struct {
	Name        string       `json:"name"`
	DisplayName string       `json:"display_name,omitempty"`
	Description string       `json:"description,omitempty"`
	Config      *StoreConfig `json:"config,omitempty"`
}

// GetStoreRequest represents a request to get a store.
type GetStoreRequest struct {
	Name string `json:"name"`
}

// DeleteStoreRequest represents a request to delete a store.
type DeleteStoreRequest struct {
	Name string `json:"name"`
}

// DeleteStoreResponse represents the result of a store deletion.
type DeleteStoreResponse struct {
	Success bool `json:"success"`
}

// GetStoreStatsRequest represents a request to get store stats.
type GetStoreStatsRequest struct {
	Name string `json:"name"`
}

// =============================================================================
// Health & Version Messages
// =============================================================================

// HealthRequest is empty.
type HealthRequest struct{}

// HealthResponse contains health status.
type HealthResponse struct {
	Status     HealthStatus                `json:"status"`
	Components map[string]*ComponentHealth `json:"components,omitempty"`
	Version    string                      `json:"version"`
}

// ComponentHealth contains health status for a component.
type ComponentHealth struct {
	Status  HealthStatus         `json:"status"`
	Message string               `json:"message,omitempty"`
	Latency *durationpb.Duration `json:"latency,omitempty"`
}

// GetLatency returns the latency as time.Duration.
func (c *ComponentHealth) GetLatency() time.Duration {
	if c.Latency == nil {
		return 0
	}
	return c.Latency.AsDuration()
}

// VersionRequest is empty.
type VersionRequest struct{}

// VersionResponse contains version information.
type VersionResponse struct {
	Version   string `json:"version"`
	Commit    string `json:"commit"`
	BuildDate string `json:"build_date"`
	GoVersion string `json:"go_version"`
}
